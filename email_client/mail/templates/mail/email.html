{% extends 'mail/base.html' %}
<!-- {% load static %} -->
{% block title %} Inbox - {{email.sender}} {% endblock %}
{% block body %}

<div class="inbox-body">
    <!-- <div class= "heading-inbox row d-none d-sm-none d-md-none d-lg-flex"> -->
    <div class= "heading-inbox row">
        <div class="col-md-8 email-icons" aria-hidden='true'>
            <a title="" data-placement="top" data-original-title="Back to Inbox" class="btn btn-sm" href="{% url 'mail:inbox' %}"><i class="fa fa-arrow-left"></i></a>
            {% if email.is_approved %}
            <a title="" href="{% url 'mail:approve' email.ref next_email %}" data-placement="top" data-original-title="Approve" class="btn btn-sm approved-icon" style="background-color: #8ae68a;; color: #fff;"><i class="fa fa-check"></i> APPROVED</a>
            {% else %}
            <a title="" href="{% url 'mail:approve' email.ref next_email %}" data-placement="top" data-original-title="Approve" class="btn btn-sm approved-icon" ><i class="fa fa-check"></i> APPROVE</a>
            {% endif %}
            
            {% if email.is_deleted %}
            <a title="" href="{% url 'mail:delete' email.ref next_email %}" data-placement="top" data-original-title="Trash" class="btn btn-sm trash-icon" style="background-color: #f5675c; color: #fff;"><i class="fa fa-trash-o"></i> DELETED</a>
            {% else %}
            <a title="" href="{% url 'mail:delete' email.ref next_email %}" data-placement="top" data-original-title="Trash" class="btn btn-sm trash-icon" ><i class="fa fa-trash-o"></i> DELETE</a>
            {% endif %}
            {% if email.is_flagged %}
            <a title="" href="{% url 'mail:flag' email.ref next_email %}" data-placement="top" data-original-title="Report" class="btn btn-sm flag-icon" style="background-color: #f0d7a9; color: #fff;"><i class="fa fa-flag-o"></i> FLAGGED</a>
            {% else %}
            <a title="" href="{% url 'mail:flag' email.ref next_email %}" data-placement="top" data-original-title="Report" class="btn btn-sm flag-icon" ><i class="fa fa-flag-o"></i> FLAG</a>
            {% endif %}
            <!-- <a title="" data-placement="top" data-original-title="Print" class="btn btn-sm disabled" ><i class="fa fa-print"></i> </a> -->
        </div>
            <ul class="unstyled inbox-pagination" role='navigation' aria-label='Email Navigation'>
                <li><span>{{ order_num }}-{{num_emails}} of {{num_emails}}</span></li>
                <li>
                    {% if prev_email > 0 %}
                        {% if email.is_deleted %}
                    <a class="np-btn" href="{% url 'mail:trashed_email' prev_email %}" aria-label="Previous Email"><i class="fa fa-angle-left pagination-left"></i></a>
                        {% elif email.is_flagged %}
                    <a class="np-btn" href="{% url 'mail:flagged_email' prev_email %}" aria-label="Previous Email"><i class="fa fa-angle-left pagination-left"></i></a>
                        {% else %}
                    <a class="np-btn" href="{% url 'mail:inbox_email' prev_email %}" aria-label="Previous Email"><i class="fa fa-angle-left pagination-left"></i></a>
                        {% endif %}
                    {% else %}
                    <a class="np-btn" aria-label="You are on the first email" disabled><i class="fa fa-angle-left pagination-left"></i></a>
                    {% endif %}
                </li>
                <li>
                    {% if next_email > 0 %}
                        {% if email.is_deleted %}
                    <a class="np-btn" href="{% url 'mail:trashed_email' next_email %}" aria-label="Next Email"><i class="fa fa-angle-right pagination-right"></i></a>                    
                        {% elif email.is_flagged %}
                    <a class="np-btn" href="{% url 'mail:flagged_email' next_email %}" aria-label="Next Email"><i class="fa fa-angle-right pagination-right"></i></a>
                        {% else %}
                    <a class="np-btn" href="{% url 'mail:inbox_email' next_email %}" aria-label="Next Email"><i class="fa fa-angle-right pagination-right"></i></a>
                        {% endif %}
                    {% else %}
                    <a class="np-btn" aria-label="You are on the last email" disabled><i class="fa fa-angle-right pagination-right"></i></a>
                    {% endif %}
                </li>
            </ul>
    </div>
    <!-- begin email header -->
        <!-- <div class="subject-info row d-none d-sm-none d-md-none d-lg-flex justify-content-between"> -->
    <div class="subject-info row justify-content-between">
        <div class="col-8 subject-row">
            <span class="visually-hidden">Email subject:</span>
            <p> {{ email.subject }}</p>
        </div>
        <div class='col align-self-center email-icons' aria-hidden='true'>
            <div class="text-end">
                <span>{{email.time_sent}}</span>
                <a title="" data-placement="top" data-original-title="Reply" class="btn btn-sm disabled" ><i class="fa fa-reply"></i></a>
                <a title="" data-placement="top" data-original-title="Favorite" class="btn btn-sm disabled" ><i class="fa fa-star"></i></a>
            </div>
        </div>
    </div>
    <!-- <div class="row email-head d-none d-sm-none d-md-none d-lg-flex"> -->
    <div class="row email-head">
        <img class='rounded-circle col' width='40' height='40' alt='' src="{% static 'img/placeholder.jpg' %}">
        <div class='email-sender col'>
            <span class='row justify-content-between'>
                    <div class="col">
                        <span class="visually-hidden">Email sender:</span>
                        <strong>{{ email.sender }}</strong>
                        <span class="visually-hidden">Sender's email address:</span>
                        <span class='sender-address'>&nbsp;{{ email.sender_address }}</span>
                    </div>
                <!-- <div class="col text-end"> {{email.time_sent}}
                </div> -->
                
            </span>
            <span class="row">
                <!-- <span class='col d-none d-lg-flex'> -->
                <span class='col sender-address'>
                    <span>to me</span>
                    <a class="sender-dropdown disabled" aria-hidden='true'>
                        <i class="fa fa-chevron-down"></i>
                    </a>
                </span>
            </span>
        </div> 
    </div> 
        <!-- end email header  -->
        <!-- begin mobile email header -->
    <!-- <div class="row d-md-flex d-lg-none">
        <div class="col-10 subject-row">
            <span class="visually-hidden">Email subject:</span>
            <h3> {{ email.subject }}</h3>
        </div>
        <div class='col align-self-center email-icons' aria-hidden='true'>
            <div class="text-end">
                <a title="" data-placement="top" data-original-title="Favorite" class="btn btn-sm disabled" ><i class="fa fa-star"></i></a>
            </div>
        </div>
    </div> -->
    <!-- <div class="row mobile-email-head d-md-flex d-lg-none justify-content-start">
            <img class='rounded-circle col' width='48' height='48' alt='' src="{% static 'img/placeholder.jpg' %}">
            <span class='email-sender col'>
                <span class='row justify-content-between'>
                        <div class="col">
                            <span class="visually-hidden">Email sender:</span>
                            <strong>{{ email.sender }}</strong>
                        </div>
                    <div class="col text-end"> {{email.time_sent}}
                    </div>
                </span>
                <span class="row d-flex d-lg-none">
                    <span class='col'>
                        <span class="visually-hidden">Sender's email address:</span>
                        <span class='sender-address'>{{ email.sender_address }}</span>
                        <div class='d-none d-lg-flex'>to <strong>me</strong>
                            <a class="sender-dropdown disabled" aria-hidden='true'>
                                <i class="fa fa-chevron-down"></i>
                            </a>
                        </div>
                    </span>
                </span>
            </span>        
    </div> -->
    <!-- end mobile email header -->
    <div class="row email-container">
        <div class='col'>
            <div class="revert">
                {% include email_fname %}
            </div>
        </div>
    </div>
    <div class="email-footer" aria-hidden='true'>
        <a class="btn btn-sm disabled"><i class="fa fa-reply"></i> Reply</a>
        <a class="btn btn-sm disabled"><i class="fa fa-arrow-right"></i> Forward</a>
        <a title="print" data-placement="top" data-original-title="Print" class="btn btn-sm disabled"><i class="fa fa-print"></i> </a>
        <a title="trash" data-placement="top" data-original-title="Trash" class="btn btn-sm disabled"><i class="fa fa-trash-o"></i></a>
    </div>
</div>
    <!-- <div class="warning-template row justify-content-left align-items-center" style= "display: inline-block; border: 2px solid #767676; border-radius: 15px; margin: 15px; padding: 10px;">
        <div class="warning-sidebar col-auto" style="">
            <i class="fa fa-exclamation-triangle fa-3x warning-icon"></i>
        </div>
        <div class="warning-inner col-auto">
            <div>
                <p class="header-text" style="padding: 5px;">Check this link! Link is not well known.</p>
                <div>
                    <div class="warning-domain row" style="padding: 5px; background-color: #DADADF; border-radius: 15px">
                        <i class="fa fa-lock"  style='padding: 5px;'><span class = "" style="border: 2px solid #DADADF; border-radius: 0px 15px 15px 0px; background-color: #DADADF;">
                            link-to-website.com/whateverelse
                        </span></i>
                        
                    </div>
                </div>
            </div>
        </div>
</div>
<div></div> -->

{% include warning_fname %}
<script src="{% static 'js/warnings.js' %}"></script>
<!-- <script src="{% static 'js/jquery.touchSwipe.min.js' %}"></script> -->

<script>
    const n = parseInt('{{ user.group_num }}');
    const p_detected = ('{{ email.is_phish }}' == 'True');
    const eid = '{{email.ref}}';
    const link = '{% url "mail:email_link" email.ref %}'
    id_links();
    if (p_detected){
        const p_link_id = '{{ email.phish_id }}';
        const p_url = '{{email.p_url}}';
        adjust_link(p_link_id,p_url);
        if (n > 0){
            load_warning(n,p_link_id,link);
        }
        // alert('{{email.p_url}}');
    }
        
    initListeners(eid);
</script>

<!-- <script>
//     $(function(){
//         $(document).swipe({
//             swipe:function(event, direction, distance, duration, fingerCount, fingerData){
//                 var prev_email = ('{{prev_email}}'!='-1');
//                 var next_email = ('{{next_email}}'!='-1');
//                 if ((direction=='right')&(prev_email)){
//                     location = '{% url "mail:inbox" %}'+'/'+'{{prev_email}}';
//                 }
//                 if ((direction=='left')&(next_email)){
//                     location = '{% url "mail:inbox" %}'+'/'+'{{next_email}}';
//                 }
//             }
//         });
//     });
</script> -->
{% endblock %}